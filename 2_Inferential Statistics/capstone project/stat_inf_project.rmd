---
title: "Statistical inference with the GSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(statsr)
```

### Load data

Make sure your data and R Markdown files are in the same directory. When loaded
your data file will be called `gss`. Delete this note when before you submit 
your work. 

```{r load-data}
load("gss.Rdata")
```

* * *

## Part 1: Data

  The data set represents an observational study - national sample gathered thru face-to-face interviews about 1.5 hours long. Each survey prior to 2004 was an independently drawn sample of English-speaking persons 18 y.o. or over, living in non-institutional arrangements within the United States. Starting in 2006 Spanish-speakers were added to the target population. Block quota sampling  and full probability sampling were employed in surveys of different years.
  The sample is a multi-stage area probability sample to the block or segment level. At the block level, however, quota sampling is used with quotas based on sex, age, and employment status.
  The Primary Sampling Units (PSUs) employed are Standard Metropolitan Statistical Areas (SMSAs) or non-metropolitan
counties selected in NORC's Master Sample. These SMSAs and counties were stratified by region, age, and race before selection.
  The chance of non-response bias was considered, so the interviewers are given instructions to canvass and interview only after 3:00 p.m. on weekdays or during the weekend or holidays. This type of sample design is most appropriate when the past experience and judgment of a project director suggest that sample biases are likely to be small relative to the precision of the measuring instrument and the decisions that are to be made.
  In addition to that, the `weighting` methods were applied, the GSS contains several weight variables (ADULTS, OVERSAMP, FORMWT, WTSSNR, WTSSALL) that users should use as needed as well as weight-related variables (ISSP+PHASE).
  Taking in the considereation all of the above (random sampling/clustering, blocking, stratifying, weighting, multi-stage probability sample, the bias encounting) we can state that the study is generalizable to the english- and spanish-speaking population of the US over 18 y.o. Because of the observational nature of the study, no random assigmnet was done so we can not conclude causality.

* * *

## Part 2: Research question

Does there appear to be a relationship between time spent in front of TV and job satisfaction level?

The question is of interest for author because he is interested in exploring how TV might potentually affect the other aspects of person's life. The author undestands that it is not possible to infer causation in the current study settings, so he only tries to find a relation between groups to understand if further analysis worths to be invested into.

* * *

## Part 3: Exploratory data analysis

Let's start with analyzing the hours spent in front of TV. Using samaries statistics and visualization, let's describe the distribution of TV hours:

```{r}
summary(gss$tvhours)
```

From the summary statistics we can see that the distribution is slightly right-skewed (because the `median` is smaller than the `mean`), alos we can witness that there is a natural boundery around `0` because watching negative number of hours does not make sense, hence we have the boundery at 0 with a long tail up to 24 hours period.

Let's visualize the data:

```{r}
ggplot(gss, aes(x = tvhours)) + geom_histogram(binwidth = 1)
```
The visualization conforms with our assumtions over moderate right skewness of the data. Now, for the sake of convinience, let's shrink number of the levels the variable has from 24 to 7:


```{r}

tvData <- gss %>% filter(!is.na(tvhours))

tvData <- tvData %>% mutate(tvhours7 = ifelse(tvhours == 0, '0 not watching',
                                              ifelse(tvhours >= 1 & tvhours <= 2, '1 some time',
                                                     ifelse(tvhours >= 3 & tvhours <= 4, '2 watching',
                                                        ifelse(tvhours >= 5 & tvhours <= 8, '3 watching a lot',
                                                            ifelse(tvhours >= 9 & tvhours <= 24, '4 all time', 'error')
                                                     )
                                              )
                                      )
                            )
)

tvData %>% group_by(tvhours7) %>% summarize(n = n())
```

As we can see we now have a ordinal categorical variable with 4 levels.

Let's explore the second variable in the same fashion, since the observations that have `NA` for TV hours spent are useless for our study, we will use the `tvData` data which we have ahd recently created. We will explore the `satjob` variable:

```{r}
summary(tvData$satjob)
```
We can see that this is an ordinal categorical variable with `4` levels. A lot of observations have `NA` values, since they are not helpful for our needs let's just filter them out:

```{r}
tvData <- tvData %>% filter(!is.na(satjob))

summary(tvData$satjob)
```
Now let's see the distributions of the categories:

```{r}
ggplot(tvData, aes(x = satjob)) + geom_bar()
```
We can see that the most people are satisfied with their jobs, the people that are dissatified with their jobs take less than 1/4 of the observations.


Now let's see the two variables on one scale, first let's build a `contingency table`:

```{r}
table(tvData$satjob, tvData$tvhours7)
```

At the first glimpse we see that the data varies across the categories, let's build a stardintized barplot to try to catch the different in the categories proportions:

```{r}
ggplot(data = tvData, aes(x = satjob, fill = tvhours7)) + geom_bar(position = "fill") +
  labs(title="Proportions who watch TV:") +
  xlab("job satisfaction") +
  ylab("amont of time spent in front of TV") +
  scale_fill_discrete(name = "How much TV is seen")
```
As we can see from the standartized barplot for levels proportions, the people who spend `some time` in front of TV are also are most satified with their jobs. The opposite relation could be spotted for the `all time` category, as the proportions of people who watches TV `all time` (9+ hours per day) seem to be growing for dissatisfied by job proportion of people. So our prior assumtion about the relation between the categories holds, so we can invest further into statistical inference methods to understand if this data provide a statisticly significant evidence that for the relation cbetween the categories.

* * *

## Part 4: Inference

NOTE: Insert code chunks as needed by clicking on the "Insert a new code chunk" 
button (green button with orange arrow) above. Make sure that your code is visible
in the project you submit. Delete this note when before you submit your work.